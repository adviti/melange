(function(a){if(a.browser.msie&&a.browser.version==8)a.expr[":"].hidden=function(b){return b.offsetWidth===0||b.offsetHeight===0||b.style.display=="none"};a.jgrid._multiselect=false;if(a.ui)if(a.ui.multiselect){if(a.ui.multiselect.prototype._setSelected){var q=a.ui.multiselect.prototype._setSelected;a.ui.multiselect.prototype._setSelected=function(b,i){b=q.call(this,b,i);if(i&&this.selectedList){var c=this.element;this.selectedList.find("li").each(function(){a(this).data("optionLink")&&a(this).data("optionLink").remove().appendTo(c)})}return b}}if(a.ui.multiselect.prototype.destroy)a.ui.multiselect.prototype.destroy=
function(){this.element.show();this.container.remove();a.Widget===undefined?a.widget.prototype.destroy.apply(this,arguments):a.Widget.prototype.destroy.apply(this,arguments)};a.jgrid._multiselect=true}a.jgrid.extend({sortableColumns:function(b){return this.each(function(){function i(){c.p.disableClick=true}var c=this,g=c.p.id;g={tolerance:"pointer",axis:"x",scrollSensitivity:"1",items:">th:not(:has(#jqgh_"+g+"_cb,#jqgh_"+g+"_rn,#jqgh_"+g+"_subgrid),:hidden)",placeholder:{element:function(f){return a(document.createElement(f[0].nodeName)).addClass(f[0].className+
" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0]},update:function(f,h){h.height(f.currentItem.innerHeight()-parseInt(f.currentItem.css("paddingTop")||0,10)-parseInt(f.currentItem.css("paddingBottom")||0,10));h.width(f.currentItem.innerWidth()-parseInt(f.currentItem.css("paddingLeft")||0,10)-parseInt(f.currentItem.css("paddingRight")||0,10))}},update:function(f,h){f=a(h.item).parent();f=a(">th",f);var j={},m=c.p.id+"_";a.each(c.p.colModel,function(l){j[this.name]=
l});var n=[];f.each(function(){var l=a(">div",this).get(0).id.replace(/^jqgh_/,"").replace(m,"");l in j&&n.push(j[l])});a(c).jqGrid("remapColumns",n,true,true);a.isFunction(c.p.sortable.update)&&c.p.sortable.update(n);setTimeout(function(){c.p.disableClick=false},50)}};if(c.p.sortable.options)a.extend(g,c.p.sortable.options);else if(a.isFunction(c.p.sortable))c.p.sortable={update:c.p.sortable};if(g.start){var d=g.start;g.start=function(f,h){i();d.call(this,f,h)}}else g.start=i;if(c.p.sortable.exclude)g.items+=
":not("+c.p.sortable.exclude+")";b.sortable(g).data("sortable").floating=true})},columnChooser:function(b){function i(e,k,p){if(k>=0){var o=e.slice(),r=o.splice(k,Math.max(e.length-k,k));if(k>e.length)k=e.length;o[k]=p;return o.concat(r)}}function c(e,k){if(e)if(typeof e=="string")a.fn[e]&&a.fn[e].apply(k,a.makeArray(arguments).slice(2));else a.isFunction(e)&&e.apply(k,a.makeArray(arguments).slice(2))}var g=this;if(!a("#colchooser_"+g[0].p.id).length){var d=a('<div id="colchooser_'+g[0].p.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>'),
f=a("select",d);b=a.extend({width:420,height:240,classname:null,done:function(e){e&&g.jqGrid("remapColumns",e,true)},msel:"multiselect",dlog:"dialog",dlog_opts:function(e){var k={};k[e.bSubmit]=function(){e.apply_perm();e.cleanup(false)};k[e.bCancel]=function(){e.cleanup(true)};return{buttons:k,close:function(){e.cleanup(true)},modal:e.modal?e.modal:false,resizable:e.resizable?e.resizable:true,width:e.width+20}},apply_perm:function(){a("option",f).each(function(){this.selected?g.jqGrid("showCol",
h[this.value].name):g.jqGrid("hideCol",h[this.value].name)});var e=[];a("option:selected",f).each(function(){e.push(parseInt(this.value,10))});a.each(e,function(){delete m[h[parseInt(this,10)].name]});a.each(m,function(){var k=parseInt(this,10);e=i(e,k,k)});b.done&&b.done.call(g,e)},cleanup:function(e){c(b.dlog,d,"destroy");c(b.msel,f,"destroy");d.remove();e&&b.done&&b.done.call(g)},msel_opts:{}},a.jgrid.col,b||{});if(a.ui)if(a.ui.multiselect)if(b.msel=="multiselect"){if(!a.jgrid._multiselect){alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");
return}b.msel_opts=a.extend(a.ui.multiselect.defaults,b.msel_opts)}b.caption&&d.attr("title",b.caption);if(b.classname){d.addClass(b.classname);f.addClass(b.classname)}if(b.width){a(">div",d).css({width:b.width,margin:"0 auto"});f.css("width",b.width)}if(b.height){a(">div",d).css("height",b.height);f.css("height",b.height-10)}var h=g.jqGrid("getGridParam","colModel"),j=g.jqGrid("getGridParam","colNames"),m={},n=[];f.empty();a.each(h,function(e){m[this.name]=e;if(this.hidedlg)this.hidden||n.push(e);
else f.append("<option value='"+e+"' "+(this.hidden?"":"selected='selected'")+">"+j[e]+"</option>")});var l=a.isFunction(b.dlog_opts)?b.dlog_opts.call(g,b):b.dlog_opts;c(b.dlog,d,l);l=a.isFunction(b.msel_opts)?b.msel_opts.call(g,b):b.msel_opts;c(b.msel,f,l)}},sortableRows:function(b){return this.each(function(){var i=this;if(i.grid)if(!i.p.treeGrid)if(a.fn.sortable){b=a.extend({cursor:"move",axis:"y",items:".jqgrow"},b||{});if(b.start&&a.isFunction(b.start)){b._start_=b.start;delete b.start}else b._start_=
false;if(b.update&&a.isFunction(b.update)){b._update_=b.update;delete b.update}else b._update_=false;b.start=function(c,g){a(g.item).css("border-width","0px");a("td",g.item).each(function(h){this.style.width=i.grid.cols[h].style.width});if(i.p.subGrid){var d=a(g.item).attr("id");try{a(i).jqGrid("collapseSubGridRow",d)}catch(f){}}b._start_&&b._start_.apply(this,[c,g])};b.update=function(c,g){a(g.item).css("border-width","");i.p.rownumbers===true&&a("td.jqgrid-rownum",i.rows).each(function(d){a(this).html(d+
1+(parseInt(i.p.page,10)-1)*parseInt(i.p.rowNum,10))});b._update_&&b._update_.apply(this,[c,g])};a("tbody:first",i).sortable(b);a("tbody:first",i).disableSelection()}})},gridDnD:function(b){return this.each(function(){function i(){var d=a.data(c,"dnd");a("tr.jqgrow:not(.ui-draggable)",c).draggable(a.isFunction(d.drag)?d.drag.call(a(c),d):d.drag)}var c=this;if(c.grid)if(!c.p.treeGrid)if(a.fn.draggable&&a.fn.droppable){a("#jqgrid_dnd").html()===null&&a("body").append("<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>");
if(typeof b=="string"&&b=="updateDnD"&&c.p.jqgdnd===true)i();else{b=a.extend({drag:function(d){return a.extend({start:function(f,h){if(c.p.subGrid){var j=a(h.helper).attr("id");try{a(c).jqGrid("collapseSubGridRow",j)}catch(m){}}for(j=0;j<a.data(c,"dnd").connectWith.length;j++)a(a.data(c,"dnd").connectWith[j]).jqGrid("getGridParam","reccount")=="0"&&a(a.data(c,"dnd").connectWith[j]).jqGrid("addRowData","jqg_empty_row",{});h.helper.addClass("ui-state-highlight");a("td",h.helper).each(function(n){this.style.width=
c.grid.headers[n].width+"px"});d.onstart&&a.isFunction(d.onstart)&&d.onstart.call(a(c),f,h)},stop:function(f,h){if(h.helper.dropped&&!d.dragcopy){var j=a(h.helper).attr("id");a(c).jqGrid("delRowData",j)}for(j=0;j<a.data(c,"dnd").connectWith.length;j++)a(a.data(c,"dnd").connectWith[j]).jqGrid("delRowData","jqg_empty_row");d.onstop&&a.isFunction(d.onstop)&&d.onstop.call(a(c),f,h)}},d.drag_opts||{})},drop:function(d){return a.extend({accept:function(f){if(!a(f).hasClass("jqgrow"))return f;var h=a(f).closest("table.ui-jqgrid-btable");
if(h.length>0&&a.data(h[0],"dnd")!==undefined){f=a.data(h[0],"dnd").connectWith;return a.inArray("#"+this.id,f)!=-1?true:false}return f},drop:function(f,h){if(a(h.draggable).hasClass("jqgrow")){var j=a(h.draggable).attr("id");j=h.draggable.parent().parent().jqGrid("getRowData",j);if(!d.dropbyname){var m=0,n={},l,e=a("#"+this.id).jqGrid("getGridParam","colModel");try{for(var k in j){if(j.hasOwnProperty(k)&&e[m]){l=e[m].name;n[l]=j[k]}m++}j=n}catch(p){}}h.helper.dropped=true;if(d.beforedrop&&a.isFunction(d.beforedrop)){l=
d.beforedrop.call(this,f,h,j,a("#"+c.id),a(this));if(typeof l!="undefined"&&l!==null&&typeof l=="object")j=l}if(h.helper.dropped){var o;if(d.autoid)if(a.isFunction(d.autoid))o=d.autoid.call(this,j);else{o=Math.ceil(Math.random()*1E3);o=d.autoidprefix+o}a("#"+this.id).jqGrid("addRowData",o,j,d.droppos)}d.ondrop&&a.isFunction(d.ondrop)&&d.ondrop.call(this,f,h,j)}}},d.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"ui-state-active",hoverClass:"ui-state-hover"},
drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5E3},dragcopy:false,dropbyname:false,droppos:"first",autoid:true,autoidprefix:"dnd_"},b||{});if(b.connectWith){b.connectWith=b.connectWith.split(",");b.connectWith=a.map(b.connectWith,function(d){return a.trim(d)});a.data(c,"dnd",b);c.p.reccount!="0"&&!c.p.jqgdnd&&i();c.p.jqgdnd=true;for(var g=0;g<b.connectWith.length;g++)a(b.connectWith[g]).droppable(a.isFunction(b.drop)?b.drop.call(a(c),b):b.drop)}}}})},gridResize:function(b){return this.each(function(){var i=
this;if(i.grid&&a.fn.resizable){b=a.extend({},b||{});if(b.alsoResize){b._alsoResize_=b.alsoResize;delete b.alsoResize}else b._alsoResize_=false;if(b.stop&&a.isFunction(b.stop)){b._stop_=b.stop;delete b.stop}else b._stop_=false;b.stop=function(c,g){a(i).jqGrid("setGridParam",{height:a("#gview_"+i.p.id+" .ui-jqgrid-bdiv").height()});a(i).jqGrid("setGridWidth",g.size.width,b.shrinkToFit);b._stop_&&b._stop_.call(i,c,g)};b.alsoResize=b._alsoResize_?eval("("+("{'#gview_"+i.p.id+" .ui-jqgrid-bdiv':true,'"+
b._alsoResize_+"':true}")+")"):a(".ui-jqgrid-bdiv","#gview_"+i.p.id);delete b._alsoResize_;a("#gbox_"+i.p.id).resizable(b)}})}})})(jQuery);
