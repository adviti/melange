(function(a){var d={};a.jgrid.extend({searchGrid:function(f){f=a.extend({recreateFilter:false,drag:true,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:true,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,closeAfterSearch:false,closeAfterReset:false,closeOnEscape:false,multipleSearch:false,multipleGroup:false,top:0,left:0,jqModal:true,modal:false,resize:true,width:450,height:"auto",dataheight:"auto",showQuery:false,errorcheck:true,
sopt:null,stringResult:undefined,onClose:null,onSearch:null,onReset:null,toTop:true,overlay:30,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:false,layer:null},a.jgrid.search,f||{});return this.each(function(){function b(){if(a.isFunction(f.beforeShowSearch)){x=f.beforeShowSearch(a("#"+r));if(typeof x==="undefined")x=true}if(x){a.jgrid.viewModal("#"+E.themodal,{gbox:"#gbox_"+r,jqm:f.jqModal,modal:f.modal,overlay:f.overlay,toTop:f.toTop});a.isFunction(f.afterShowSearch)&&
f.afterShowSearch(a("#"+r))}}var e=this;if(e.grid){var r="fbox_"+e.p.id,x=true,E={themodal:"searchmod"+r,modalhead:"searchhd"+r,modalcontent:"searchcnt"+r,scrollelm:r},B=e.p.postData[f.sFilter];if(typeof B==="string")B=a.jgrid.parse(B);f.recreateFilter===true&&a("#"+E.themodal).remove();if(a("#"+E.themodal).html()!==null)b();else{var A=a("<div><div id='"+r+"' class='searchFilter' style='overflow:auto'></div></div>").insertBefore("#gview_"+e.p.id),n="left",k="";if(e.p.direction=="rtl"){n="right";k=
" style='text-align:left'";A.attr("dir","rtl")}a.isFunction(f.onInitializeSearch)&&f.onInitializeSearch(a("#"+r));var s=a.extend([],e.p.colModel),N="<a href='javascript:void(0)' id='"+r+"_search' class='fm-button ui-state-default ui-corner-all fm-button-icon-right ui-reset'><span class='ui-icon ui-icon-search'></span>"+f.Find+"</a>",c="<a href='javascript:void(0)' id='"+r+"_reset' class='fm-button ui-state-default ui-corner-all fm-button-icon-left ui-search'><span class='ui-icon ui-icon-arrowreturnthick-1-w'></span>"+
f.Reset+"</a>",t="",p="",j,o=false,F=-1;if(f.showQuery)t="<a href='javascript:void(0)' id='"+r+"_query' class='fm-button ui-state-default ui-corner-all fm-button-icon-left'><span class='ui-icon ui-icon-comment'></span>Query</a>";if(f.columns.length)s=f.columns;else a.each(s,function(u,y){if(!y.label)y.label=e.p.colNames[u];if(!o){var G=typeof y.search==="undefined"?true:y.search,l=y.hidden===true;if(y.searchoptions&&y.searchoptions.searchhidden===true&&G||G&&!l){o=true;j=y.index||y.name;F=u}}});if(!B&&
j||f.multipleSearch===false){var J="eq";if(F>=0&&s[F].searchoptions&&s[F].searchoptions.sopt)J=s[F].searchoptions.sopt[0];else if(f.sopt&&f.sopt.length)J=f.sopt[0];B={groupOp:"AND",rules:[{field:j,op:J,data:""}]}}o=false;if(f.tmplNames&&f.tmplNames.length){o=true;p=f.tmplLabel;p+="<select class='ui-template'>";p+="<option value='default'>Default</option>";a.each(f.tmplNames,function(u,y){p+="<option value='"+u+"'>"+y+"</option>"});p+="</select>"}n="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+
r+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='EditButton' style='text-align:"+n+"'>"+c+p+"</td><td class='EditButton' "+k+">"+t+N+"</td></tr></tbody></table>";a("#"+r).jqFilter({columns:s,filter:f.loadDefaults?B:null,showQuery:f.showQuery,errorcheck:f.errorcheck,sopt:f.sopt,groupButton:f.multipleGroup,ruleButtons:f.multipleSearch,afterRedraw:f.afterRedraw,_gridsopt:a.jgrid.search.odata,onChange:function(){this.p.showQuery&&a(".query",
this).html(this.toUserFriendlyString())},direction:e.p.direction});A.append(n);o&&f.tmplFilters&&f.tmplFilters.length&&a(".ui-template",A).bind("change",function(){var u=a(this).val();u=="default"?a("#"+r).jqFilter("addFilter",B):a("#"+r).jqFilter("addFilter",f.tmplFilters[parseInt(u,10)]);return false});if(f.multipleGroup===true)f.multipleSearch=true;a.isFunction(f.onInitializeSearch)&&f.onInitializeSearch(a("#"+r));f.gbox="#gbox_"+r;f.layer?a.jgrid.createModal(E,A,f,"#gview_"+e.p.id,a("#gbox_"+
e.p.id)[0],"#"+f.layer,{position:"relative"}):a.jgrid.createModal(E,A,f,"#gview_"+e.p.id,a("#gbox_"+e.p.id)[0]);t&&a("#"+r+"_query").bind("click",function(){a(".queryresult",A).toggle();return false});if(f.stringResult===undefined)f.stringResult=f.multipleSearch;a("#"+r+"_search").bind("click",function(){var u=a("#"+r),y={},G,l=u.jqFilter("filterData");if(f.errorcheck){u[0].hideError();f.showQuery||u.jqFilter("toSQLString");if(u[0].p.error){u[0].showError();return false}}if(f.stringResult){try{G=
xmlJsonClass.toJson(l,"","",false)}catch(D){try{G=JSON.stringify(l)}catch(h){}}if(typeof G==="string"){y[f.sFilter]=G;a.each([f.sField,f.sValue,f.sOper],function(){y[this]=""})}}else if(f.multipleSearch){y[f.sFilter]=l;a.each([f.sField,f.sValue,f.sOper],function(){y[this]=""})}else{y[f.sField]=l.rules[0].field;y[f.sValue]=l.rules[0].data;y[f.sOper]=l.rules[0].op;y[f.sFilter]=""}e.p.search=true;a.extend(e.p.postData,y);a.isFunction(f.onSearch)&&f.onSearch();a(e).trigger("reloadGrid",[{page:1}]);f.closeAfterSearch&&
a.jgrid.hideModal("#"+E.themodal,{gb:"#gbox_"+e.p.id,jqm:f.jqModal,onClose:f.onClose});return false});a("#"+r+"_reset").bind("click",function(){var u={},y=a("#"+r);e.p.search=false;if(f.multipleSearch===false)u[f.sField]=u[f.sValue]=u[f.sOper]="";else u[f.sFilter]="";y[0].resetFilter();o&&a(".ui-template",A).val("default");a.extend(e.p.postData,u);a.isFunction(f.onReset)&&f.onReset();a(e).trigger("reloadGrid",[{page:1}]);return false});b();a(".fm-button:not(.ui-state-disabled)",A).hover(function(){a(this).addClass("ui-state-hover")},
function(){a(this).removeClass("ui-state-hover")})}}})},editGridRow:function(f,b){b=a.extend({top:0,left:0,width:300,height:"auto",dataheight:"auto",modal:false,overlay:30,drag:true,resize:true,url:null,mtype:"POST",clearAfterAdd:true,closeAfterEdit:false,reloadAfterSubmit:true,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:false,
jqModal:true,closeOnEscape:false,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[false,13],navkeys:[false,38,40],checkOnSubmit:false,checkOnUpdate:false,_savedData:{},processing:false,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:true},a.jgrid.edit,b||{});d[a(this)[0].p.id]=b;return this.each(function(){function e(){a("#"+j+" > tbody > tr > td > .FormElement").each(function(){var g=a(".customelement",this);if(g.length){var m=a(g[0]).attr("name");
a.each(c.p.colModel,function(){if(this.name===m&&this.editoptions&&a.isFunction(this.editoptions.custom_value)){try{h[m]=this.editoptions.custom_value(a("#"+a.jgrid.jqID(m),"#"+j),"get");if(h[m]===undefined)throw"e1";}catch(q){q==="e1"?a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose):a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,q.message,jQuery.jgrid.edit.bClose)}return true}})}else{switch(a(this).get(0).type){case "checkbox":if(a(this).is(":checked"))h[this.name]=
a(this).val();else{g=a(this).attr("offval");h[this.name]=g}break;case "select-one":h[this.name]=a("option:selected",this).val();P[this.name]=a("option:selected",this).text();break;case "select-multiple":h[this.name]=a(this).val();h[this.name]=h[this.name]?h[this.name].join(","):"";var w=[];a("option:selected",this).each(function(q,H){w[q]=a(H).text()});P[this.name]=w.join(",");break;case "password":case "text":case "textarea":case "button":h[this.name]=a(this).val();break}if(c.p.autoencode)h[this.name]=
a.jgrid.htmlEncode(h[this.name])}});return true}function r(g,m,w,q){var H,C,v,K=0,z,Q,I,U=[],M=false,aa="",S;for(S=1;S<=q;S++)aa+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";if(g!="_empty")M=a(m).jqGrid("getInd",g);a(m.p.colModel).each(function(T){H=this.name;Q=(C=this.editrules&&this.editrules.edithidden===true?false:this.hidden===true?true:false)?"style='display:none'":"";if(H!=="cb"&&H!=="subgrid"&&this.editable===true&&H!=="rn"){if(M===false)z="";else if(H==m.p.ExpandColumn&&
m.p.treeGrid===true)z=a("td:eq("+T+")",m.rows[M]).text();else{try{z=a.unformat(a("td:eq("+T+")",m.rows[M]),{rowId:g,colModel:this},T)}catch(ga){z=this.edittype&&this.edittype=="textarea"?a("td:eq("+T+")",m.rows[M]).text():a("td:eq("+T+")",m.rows[M]).html()}if(!z||z=="&nbsp;"||z=="&#160;"||z.length==1&&z.charCodeAt(0)==160)z=""}var Y=a.extend({},this.editoptions||{},{id:H,name:H}),Z=a.extend({},{elmprefix:"",elmsuffix:"",rowabove:false,rowcontent:""},this.formoptions||{}),ea=parseInt(Z.rowpos,10)||
K+1,ha=parseInt((parseInt(Z.colpos,10)||1)*2,10);if(g=="_empty"&&Y.defaultValue)z=a.isFunction(Y.defaultValue)?Y.defaultValue():Y.defaultValue;if(!this.edittype)this.edittype="text";if(c.p.autoencode)z=a.jgrid.htmlDecode(z);I=a.jgrid.createEl(this.edittype,Y,z,false,a.extend({},a.jgrid.ajaxOptions,m.p.ajaxSelectOptions||{}));if(z===""&&this.edittype=="checkbox")z=a(I).attr("offval");if(z===""&&this.edittype=="select")z=a("option:eq(0)",I).text();if(d[c.p.id].checkOnSubmit||d[c.p.id].checkOnUpdate)d[c.p.id]._savedData[H]=
z;a(I).addClass("FormElement");if(this.edittype=="text"||this.edittype=="textarea")a(I).addClass("ui-widget-content ui-corner-all");v=a(w).find("tr[rowpos="+ea+"]");if(Z.rowabove){Y=a("<tr><td class='contentinfo' colspan='"+q*2+"'>"+Z.rowcontent+"</td></tr>");a(w).append(Y);Y[0].rp=ea}if(v.length===0){v=a("<tr "+Q+" rowpos='"+ea+"'></tr>").addClass("FormData").attr("id","tr_"+H);a(v).append(aa);a(w).append(v);v[0].rp=ea}a("td:eq("+(ha-2)+")",v[0]).html(typeof Z.label==="undefined"?m.p.colNames[T]:
Z.label);a("td:eq("+(ha-1)+")",v[0]).append(Z.elmprefix).append(I).append(Z.elmsuffix);U[K]=T;K++}});if(K>0){S=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(q*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+m.p.id+"_id' value='"+g+"'/></td></tr>");S[0].rp=K+999;a(w).append(S);if(d[c.p.id].checkOnSubmit||d[c.p.id].checkOnUpdate)d[c.p.id]._savedData[m.p.id+"_id"]=g}return U}function x(g,m,w){var q,H=0,C,v,K,z,Q;if(d[c.p.id].checkOnSubmit||
d[c.p.id].checkOnUpdate){d[c.p.id]._savedData={};d[c.p.id]._savedData[m.p.id+"_id"]=g}var I=m.p.colModel;if(g=="_empty"){a(I).each(function(){q=this.name;K=a.extend({},this.editoptions||{});if((v=a("#"+a.jgrid.jqID(q),"#"+w))&&v.length&&v[0]!==null){z="";if(K.defaultValue){z=a.isFunction(K.defaultValue)?K.defaultValue():K.defaultValue;if(v[0].type=="checkbox"){Q=z.toLowerCase();if(Q.search(/(false|0|no|off|undefined)/i)<0&&Q!==""){v[0].checked=true;v[0].defaultChecked=true;v[0].value=z}else{v[0].checked=
false;v[0].defaultChecked=false}}else v.val(z)}else if(v[0].type=="checkbox"){v[0].checked=false;v[0].defaultChecked=false;z=a(v).attr("offval")}else if(v[0].type&&v[0].type.substr(0,6)=="select")v[0].selectedIndex=0;else v.val(z);if(d[c.p.id].checkOnSubmit===true||d[c.p.id].checkOnUpdate)d[c.p.id]._savedData[q]=z}});a("#id_g","#"+w).val(g)}else{var U=a(m).jqGrid("getInd",g,true);if(U){a("td",U).each(function(M){q=I[M].name;if(q!=="cb"&&q!=="subgrid"&&q!=="rn"&&I[M].editable===true){if(q==m.p.ExpandColumn&&
m.p.treeGrid===true)C=a(this).text();else try{C=a.unformat(a(this),{rowId:g,colModel:I[M]},M)}catch(aa){C=I[M].edittype=="textarea"?a(this).text():a(this).html()}if(c.p.autoencode)C=a.jgrid.htmlDecode(C);if(d[c.p.id].checkOnSubmit===true||d[c.p.id].checkOnUpdate)d[c.p.id]._savedData[q]=C;q=a.jgrid.jqID(q);switch(I[M].edittype){case "password":case "text":case "button":case "image":case "textarea":if(C=="&nbsp;"||C=="&#160;"||C.length==1&&C.charCodeAt(0)==160)C="";a("#"+q,"#"+w).val(C);break;case "select":var S=
C.split(",");S=a.map(S,function(ga){return a.trim(ga)});a("#"+q+" option","#"+w).each(function(){this.selected=!I[M].editoptions.multiple&&(a.trim(C)==a.trim(a(this).text())||S[0]==a.trim(a(this).text())||S[0]==a.trim(a(this).val()))?true:I[M].editoptions.multiple?a.inArray(a.trim(a(this).text()),S)>-1||a.inArray(a.trim(a(this).val()),S)>-1?true:false:false});break;case "checkbox":C+="";if(I[M].editoptions&&I[M].editoptions.value)if(I[M].editoptions.value.split(":")[0]==C){a("#"+q,"#"+w)[c.p.useProp?
"prop":"attr"]("checked",true);a("#"+q,"#"+w)[c.p.useProp?"prop":"attr"]("defaultChecked",true)}else{a("#"+q,"#"+w)[c.p.useProp?"prop":"attr"]("checked",false);a("#"+q,"#"+w)[c.p.useProp?"prop":"attr"]("defaultChecked",false)}else{C=C.toLowerCase();if(C.search(/(false|0|no|off|undefined)/i)<0&&C!==""){a("#"+q,"#"+w)[c.p.useProp?"prop":"attr"]("checked",true);a("#"+q,"#"+w)[c.p.useProp?"prop":"attr"]("defaultChecked",true)}else{a("#"+q,"#"+w)[c.p.useProp?"prop":"attr"]("checked",false);a("#"+q,"#"+
w)[c.p.useProp?"prop":"attr"]("defaultChecked",false)}}break;case "custom":try{if(I[M].editoptions&&a.isFunction(I[M].editoptions.custom_value))I[M].editoptions.custom_value(a("#"+q,"#"+w),"set",C);else throw"e1";}catch(T){T=="e1"?a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose):a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,T.message,jQuery.jgrid.edit.bClose)}break}H++}});H>0&&a("#id_g","#"+j).val(g)}}}function E(){var g,
m=[true,"",""],w={},q=c.p.prmNames,H,C,v,K;if(a.isFunction(d[c.p.id].beforeCheckValues)){var z=d[c.p.id].beforeCheckValues(h,a("#"+p),h[c.p.id+"_id"]=="_empty"?q.addoper:q.editoper);if(z&&typeof z==="object")h=z}for(v in h)if(h.hasOwnProperty(v)){m=a.jgrid.checkValues(h[v],v,c);if(m[0]===false)break}A();if(m[0]){if(a.isFunction(d[c.p.id].onclickSubmit))w=d[c.p.id].onclickSubmit(d[c.p.id],h)||{};if(a.isFunction(d[c.p.id].beforeSubmit))m=d[c.p.id].beforeSubmit(h,a("#"+p))}if(m[0]&&!d[c.p.id].processing){d[c.p.id].processing=
true;a("#sData","#"+j+"_2").addClass("ui-state-active");C=q.oper;H=q.id;h[C]=a.trim(h[c.p.id+"_id"])=="_empty"?q.addoper:q.editoper;if(h[C]!=q.addoper)h[H]=h[c.p.id+"_id"];else if(h[H]===undefined)h[H]=h[c.p.id+"_id"];delete h[c.p.id+"_id"];h=a.extend(h,d[c.p.id].editData,w);if(c.p.treeGrid===true){if(h[C]==q.addoper){K=a(c).jqGrid("getGridParam","selrow");h[c.p.treeGridModel=="adjacency"?c.p.treeReader.parent_id_field:"parent_id"]=K}for(i in c.p.treeReader){w=c.p.treeReader[i];if(h.hasOwnProperty(w))h[C]==
q.addoper&&i==="parent_id_field"||delete h[w]}}h[H]=a.jgrid.stripPref(c.p.idPrefix,h[H]);w=a.extend({url:d[c.p.id].url?d[c.p.id].url:a(c).jqGrid("getGridParam","editurl"),type:d[c.p.id].mtype,data:a.isFunction(d[c.p.id].serializeEditData)?d[c.p.id].serializeEditData(h):h,complete:function(Q,I){h[H]=c.p.idPrefix+h[H];if(I!="success"){m[0]=false;m[1]=a.isFunction(d[c.p.id].errorTextFormat)?d[c.p.id].errorTextFormat(Q):I+" Status: '"+Q.statusText+"'. Error code: "+Q.status}else if(a.isFunction(d[c.p.id].afterSubmit))m=
d[c.p.id].afterSubmit(Q,h);if(m[0]===false){a("#FormError>td","#"+j).html(m[1]);a("#FormError","#"+j).show()}else{a.each(c.p.colModel,function(){if(P[this.name]&&this.formatter&&this.formatter=="select")try{delete P[this.name]}catch(aa){}});h=a.extend(h,P);c.p.autoencode&&a.each(h,function(aa,S){h[aa]=a.jgrid.htmlDecode(S)});if(h[C]==q.addoper){m[2]||(m[2]=a.jgrid.randId());h[H]=m[2];if(d[c.p.id].closeAfterAdd){if(d[c.p.id].reloadAfterSubmit)a(c).trigger("reloadGrid");else if(c.p.treeGrid===true)a(c).jqGrid("addChildNode",
m[2],K,h);else{a(c).jqGrid("addRowData",m[2],h,b.addedrow);a(c).jqGrid("setSelection",m[2])}a.jgrid.hideModal("#"+o.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose})}else if(d[c.p.id].clearAfterAdd){if(d[c.p.id].reloadAfterSubmit)a(c).trigger("reloadGrid");else c.p.treeGrid===true?a(c).jqGrid("addChildNode",m[2],K,h):a(c).jqGrid("addRowData",m[2],h,b.addedrow);x("_empty",c,p)}else if(d[c.p.id].reloadAfterSubmit)a(c).trigger("reloadGrid");else c.p.treeGrid===true?a(c).jqGrid("addChildNode",
m[2],K,h):a(c).jqGrid("addRowData",m[2],h,b.addedrow)}else{if(d[c.p.id].reloadAfterSubmit){a(c).trigger("reloadGrid");d[c.p.id].closeAfterEdit||setTimeout(function(){a(c).jqGrid("setSelection",h[H])},1E3)}else c.p.treeGrid===true?a(c).jqGrid("setTreeRow",h[H],h):a(c).jqGrid("setRowData",h[H],h);d[c.p.id].closeAfterEdit&&a.jgrid.hideModal("#"+o.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose})}if(a.isFunction(d[c.p.id].afterComplete)){g=Q;setTimeout(function(){d[c.p.id].afterComplete(g,
h,a("#"+p));g=null},500)}if(d[c.p.id].checkOnSubmit||d[c.p.id].checkOnUpdate){a("#"+p).data("disabled",false);if(d[c.p.id]._savedData[c.p.id+"_id"]!="_empty")for(var U in d[c.p.id]._savedData)if(h[U])d[c.p.id]._savedData[U]=h[U]}}d[c.p.id].processing=false;a("#sData","#"+j+"_2").removeClass("ui-state-active");try{a(":input:visible","#"+p)[0].focus()}catch(M){}}},a.jgrid.ajaxOptions,d[c.p.id].ajaxEditOptions);if(!w.url&&!d[c.p.id].useDataProxy)if(a.isFunction(c.p.dataProxy))d[c.p.id].useDataProxy=
true;else{m[0]=false;m[1]+=" "+a.jgrid.errors.nourl}if(m[0])if(d[c.p.id].useDataProxy){v=c.p.dataProxy.call(c,w,"set_"+c.p.id);if(typeof v=="undefined")v=[true,""];if(v[0]===false){m[0]=false;m[1]=v[1]||"Error deleting the selected row!"}else{w.data.oper==q.addoper&&d[c.p.id].closeAfterAdd&&a.jgrid.hideModal("#"+o.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose});w.data.oper==q.editoper&&d[c.p.id].closeAfterEdit&&a.jgrid.hideModal("#"+o.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose})}}else a.ajax(w)}if(m[0]===
false){a("#FormError>td","#"+j).html(m[1]);a("#FormError","#"+j).show()}}function B(g,m){var w=false,q;for(q in g)if(g[q]!=m[q]){w=true;break}return w}function A(){a.each(c.p.colModel,function(g,m){if(m.editoptions&&m.editoptions.NullIfEmpty===true)if(h.hasOwnProperty(m.name)&&h[m.name]=="")h[m.name]="null"})}function n(){var g=true;a("#FormError","#"+j).hide();if(d[c.p.id].checkOnUpdate){h={};P={};e();O=a.extend({},h,P);if(V=B(O,d[c.p.id]._savedData)){a("#"+p).data("disabled",true);a(".confirm",
"#"+o.themodal).show();g=false}}return g}function k(){if(f!=="_empty"&&typeof c.p.savedRow!=="undefined"&&c.p.savedRow.length>0&&a.isFunction(a.fn.jqGrid.restoreRow))for(var g=0;g<c.p.savedRow.length;g++)if(c.p.savedRow[g].id==f){a(c).jqGrid("restoreRow",f);break}}function s(g,m){g===0?a("#pData","#"+j+"_2").addClass("ui-state-disabled"):a("#pData","#"+j+"_2").removeClass("ui-state-disabled");g==m?a("#nData","#"+j+"_2").addClass("ui-state-disabled"):a("#nData","#"+j+"_2").removeClass("ui-state-disabled")}
function N(){var g=a(c).jqGrid("getDataIDs"),m=a("#id_g","#"+j).val();return[a.inArray(m,g),g]}var c=this;if(c.grid&&f){var t=c.p.id,p="FrmGrid_"+t,j="TblGrid_"+t,o={themodal:"editmod"+t,modalhead:"edithd"+t,modalcontent:"editcnt"+t,scrollelm:p},F=a.isFunction(d[c.p.id].beforeShowForm)?d[c.p.id].beforeShowForm:false,J=a.isFunction(d[c.p.id].afterShowForm)?d[c.p.id].afterShowForm:false,u=a.isFunction(d[c.p.id].beforeInitData)?d[c.p.id].beforeInitData:false,y=a.isFunction(d[c.p.id].onInitializeForm)?
d[c.p.id].onInitializeForm:false,G=true,l=1,D=0,h,P,O,V;if(f==="new"){f="_empty";b.caption=d[c.p.id].addCaption}else b.caption=d[c.p.id].editCaption;b.recreateForm===true&&a("#"+o.themodal).html()!==null&&a("#"+o.themodal).remove();var R=true;if(b.checkOnUpdate&&b.jqModal&&!b.modal)R=false;if(a("#"+o.themodal).html()!==null){if(u){G=u(a("#"+p));if(typeof G=="undefined")G=true}if(G===false)return;k();a(".ui-jqdialog-title","#"+o.modalhead).html(b.caption);a("#FormError","#"+j).hide();if(d[c.p.id].topinfo){a(".topinfo",
"#"+j).html(d[c.p.id].topinfo);a(".tinfo","#"+j).show()}else a(".tinfo","#"+j).hide();if(d[c.p.id].bottominfo){a(".bottominfo","#"+j+"_2").html(d[c.p.id].bottominfo);a(".binfo","#"+j+"_2").show()}else a(".binfo","#"+j+"_2").hide();x(f,c,p);f=="_empty"||!d[c.p.id].viewPagerButtons?a("#pData, #nData","#"+j+"_2").hide():a("#pData, #nData","#"+j+"_2").show();if(d[c.p.id].processing===true){d[c.p.id].processing=false;a("#sData","#"+j+"_2").removeClass("ui-state-active")}if(a("#"+p).data("disabled")===
true){a(".confirm","#"+o.themodal).hide();a("#"+p).data("disabled",false)}F&&F(a("#"+p));a("#"+o.themodal).data("onClose",d[c.p.id].onClose);a.jgrid.viewModal("#"+o.themodal,{gbox:"#gbox_"+t,jqm:b.jqModal,jqM:false,overlay:b.overlay,modal:b.modal});R||a(".jqmOverlay").click(function(){if(!n())return false;a.jgrid.hideModal("#"+o.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose});return false});J&&J(a("#"+p))}else{var L=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px";L=a("<form name='FormPost' id='"+
p+"' class='FormGrid' onSubmit='return false;' style='width:100%;overflow:auto;position:relative;height:"+L+";'></form>").data("disabled",false);var W=a("<table id='"+j+"' class='EditTable' cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>");if(u){G=u(a("#"+p));if(typeof G=="undefined")G=true}if(G===false)return;k();a(c.p.colModel).each(function(){var g=this.formoptions;l=Math.max(l,g?g.colpos||0:0);D=Math.max(D,g?g.rowpos||0:0)});a(L).append(W);u=a("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+
l*2+"'></td></tr>");u[0].rp=0;a(W).append(u);u=a("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+l*2+"'>"+d[c.p.id].topinfo+"</td></tr>");u[0].rp=0;a(W).append(u);G=(u=c.p.direction=="rtl"?true:false)?"nData":"pData";var X=u?"pData":"nData";r(f,c,W,l);G="<a href='javascript:void(0)' id='"+G+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>";X="<a href='javascript:void(0)' id='"+X+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>";
var ba="<a href='javascript:void(0)' id='sData' class='fm-button ui-state-default ui-corner-all'>"+b.bSubmit+"</a>",$="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+b.bCancel+"</a>";G="<table border='0' cellspacing='0' cellpadding='0' class='EditTable' id='"+j+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(u?X+G:G+X)+"</td><td class='EditButton'>"+ba+$+"</td></tr>";
G+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+d[c.p.id].bottominfo+"</td></tr>";G+="</tbody></table>";if(D>0){var ca=[],da={};a.each(a(W)[0].rows,function(g,m){ca[g]=m});ca.sort(function(g,m){if(g.rp>m.rp)return 1;if(g.rp<m.rp)return-1;return 0});a.each(ca,function(g,m){da.html+=m});a("tbody",W).append(da.html)}b.gbox="#gbox_"+t;var fa=false;if(b.closeOnEscape===true){b.closeOnEscape=false;fa=true}L=a("<span></span>").append(L).append(G);a.jgrid.createModal(o,L,b,
"#gview_"+c.p.id,a("#gbox_"+c.p.id)[0]);if(u){a("#pData, #nData","#"+j+"_2").css("float","right");a(".EditButton","#"+j+"_2").css("text-align","left")}d[c.p.id].topinfo&&a(".tinfo","#"+j).show();d[c.p.id].bottominfo&&a(".binfo","#"+j+"_2").show();G=L=null;a("#"+o.themodal).keydown(function(g){var m=g.target;if(a("#"+p).data("disabled")===true)return false;if(d[c.p.id].savekey[0]===true&&g.which==d[c.p.id].savekey[1])if(m.tagName!="TEXTAREA"){a("#sData","#"+j+"_2").trigger("click");return false}if(g.which===
27){if(!n())return false;fa&&a.jgrid.hideModal(this,{gb:b.gbox,jqm:b.jqModal,onClose:d[c.p.id].onClose});return false}if(d[c.p.id].navkeys[0]===true){if(a("#id_g","#"+j).val()=="_empty")return true;if(g.which==d[c.p.id].navkeys[1]){a("#pData","#"+j+"_2").trigger("click");return false}if(g.which==d[c.p.id].navkeys[2]){a("#nData","#"+j+"_2").trigger("click");return false}}});if(b.checkOnUpdate){a("a.ui-jqdialog-titlebar-close span","#"+o.themodal).removeClass("jqmClose");a("a.ui-jqdialog-titlebar-close",
"#"+o.themodal).unbind("click").click(function(){if(!n())return false;a.jgrid.hideModal("#"+o.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose});return false})}b.saveicon=a.extend([true,"left","ui-icon-disk"],b.saveicon);b.closeicon=a.extend([true,"left","ui-icon-close"],b.closeicon);if(b.saveicon[0]===true)a("#sData","#"+j+"_2").addClass(b.saveicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.saveicon[2]+"'></span>");if(b.closeicon[0]===
true)a("#cData","#"+j+"_2").addClass(b.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.closeicon[2]+"'></span>");if(d[c.p.id].checkOnSubmit||d[c.p.id].checkOnUpdate){ba="<a href='javascript:void(0)' id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+b.bYes+"</a>";X="<a href='javascript:void(0)' id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+b.bNo+"</a>";$="<a href='javascript:void(0)' id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+
b.bExit+"</a>";L=b.zIndex||999;L++;a("<div class='ui-widget-overlay jqgrid-overlay confirm' style='z-index:"+L+";display:none;'>&#160;"+(a.browser.msie&&a.browser.version==6?'<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>':"")+"</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(L+1)+"'>"+b.saveData+"<br/><br/>"+ba+X+$+"</div>").insertAfter("#"+p);a("#sNew","#"+o.themodal).click(function(){E();a("#"+
p).data("disabled",false);a(".confirm","#"+o.themodal).hide();return false});a("#nNew","#"+o.themodal).click(function(){a(".confirm","#"+o.themodal).hide();a("#"+p).data("disabled",false);setTimeout(function(){a(":input","#"+p)[0].focus()},0);return false});a("#cNew","#"+o.themodal).click(function(){a(".confirm","#"+o.themodal).hide();a("#"+p).data("disabled",false);a.jgrid.hideModal("#"+o.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose});return false})}y&&y(a("#"+p));f=="_empty"||
!d[c.p.id].viewPagerButtons?a("#pData,#nData","#"+j+"_2").hide():a("#pData,#nData","#"+j+"_2").show();F&&F(a("#"+p));a("#"+o.themodal).data("onClose",d[c.p.id].onClose);a.jgrid.viewModal("#"+o.themodal,{gbox:"#gbox_"+t,jqm:b.jqModal,overlay:b.overlay,modal:b.modal});R||a(".jqmOverlay").click(function(){if(!n())return false;a.jgrid.hideModal("#"+o.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose});return false});J&&J(a("#"+p));a(".fm-button","#"+o.themodal).hover(function(){a(this).addClass("ui-state-hover")},
function(){a(this).removeClass("ui-state-hover")});a("#sData","#"+j+"_2").click(function(){h={};P={};a("#FormError","#"+j).hide();e();if(h[c.p.id+"_id"]=="_empty")E();else if(b.checkOnSubmit===true){O=a.extend({},h,P);if(V=B(O,d[c.p.id]._savedData)){a("#"+p).data("disabled",true);a(".confirm","#"+o.themodal).show()}else E()}else E();return false});a("#cData","#"+j+"_2").click(function(){if(!n())return false;a.jgrid.hideModal("#"+o.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose});
return false});a("#nData","#"+j+"_2").click(function(){if(!n())return false;a("#FormError","#"+j).hide();var g=N();g[0]=parseInt(g[0],10);if(g[0]!=-1&&g[1][g[0]+1]){a.isFunction(b.onclickPgButtons)&&b.onclickPgButtons("next",a("#"+p),g[1][g[0]]);x(g[1][g[0]+1],c,p);a(c).jqGrid("setSelection",g[1][g[0]+1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("next",a("#"+p),g[1][g[0]+1]);s(g[0]+1,g[1].length-1)}return false});a("#pData","#"+j+"_2").click(function(){if(!n())return false;a("#FormError",
"#"+j).hide();var g=N();if(g[0]!=-1&&g[1][g[0]-1]){a.isFunction(b.onclickPgButtons)&&b.onclickPgButtons("prev",a("#"+p),g[1][g[0]]);x(g[1][g[0]-1],c,p);a(c).jqGrid("setSelection",g[1][g[0]-1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("prev",a("#"+p),g[1][g[0]-1]);s(g[0]-1,g[1].length-1)}return false})}F=N();s(F[0],F[1].length-1)}})},viewGridRow:function(f,b){b=a.extend({top:0,left:0,width:0,height:"auto",dataheight:"auto",modal:false,overlay:30,drag:true,resize:true,jqModal:true,
closeOnEscape:false,labelswidth:"30%",closeicon:[],navkeys:[false,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:true},a.jgrid.view,b||{});return this.each(function(){function e(){if(b.closeOnEscape===true||b.navkeys[0]===true)setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+N.modalhead).focus()},0)}function r(l,D,h,P){for(var O,V,R,L=0,W,X,ba=[],$=false,ca="<td class='CaptionTD form-view-label ui-widget-content' width='"+b.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>",
da="",fa=["integer","number","currency"],g=0,m=0,w,q,H,C=1;C<=P;C++)da+=C==1?ca:"<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>";a(D.p.colModel).each(function(){V=this.editrules&&this.editrules.edithidden===true?false:this.hidden===true?true:false;if(!V&&this.align==="right")if(this.formatter&&a.inArray(this.formatter,fa)!==-1)g=Math.max(g,parseInt(this.width,10));else m=Math.max(m,parseInt(this.width,10))});w=g!==
0?g:m!==0?m:0;$=a(D).jqGrid("getInd",l);a(D.p.colModel).each(function(v){O=this.name;q=false;X=(V=this.editrules&&this.editrules.edithidden===true?false:this.hidden===true?true:false)?"style='display:none'":"";H=typeof this.viewable!="boolean"?true:this.viewable;if(O!=="cb"&&O!=="subgrid"&&O!=="rn"&&H){W=$===false?"":O==D.p.ExpandColumn&&D.p.treeGrid===true?a("td:eq("+v+")",D.rows[$]).text():a("td:eq("+v+")",D.rows[$]).html();q=this.align==="right"&&w!==0?true:false;a.extend({},this.editoptions||
{},{id:O,name:O});var K=a.extend({},{rowabove:false,rowcontent:""},this.formoptions||{}),z=parseInt(K.rowpos,10)||L+1,Q=parseInt((parseInt(K.colpos,10)||1)*2,10);if(K.rowabove){var I=a("<tr><td class='contentinfo' colspan='"+P*2+"'>"+K.rowcontent+"</td></tr>");a(h).append(I);I[0].rp=z}R=a(h).find("tr[rowpos="+z+"]");if(R.length===0){R=a("<tr "+X+" rowpos='"+z+"'></tr>").addClass("FormData").attr("id","trv_"+O);a(R).append(da);a(h).append(R);R[0].rp=z}a("td:eq("+(Q-2)+")",R[0]).html("<b>"+(typeof K.label===
"undefined"?D.p.colNames[v]:K.label)+"</b>");a("td:eq("+(Q-1)+")",R[0]).append("<span>"+W+"</span>").attr("id","v_"+O);q&&a("td:eq("+(Q-1)+") span",R[0]).css({"text-align":"right",width:w+"px"});ba[L]=v;L++}});if(L>0){l=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(P*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+l+"'/></td></tr>");l[0].rp=L+99;a(h).append(l)}return ba}function x(l,D){var h,P,O=0,V,R;if(R=a(D).jqGrid("getInd",
l,true)){a("td",R).each(function(L){h=D.p.colModel[L].name;P=D.p.colModel[L].editrules&&D.p.colModel[L].editrules.edithidden===true?false:D.p.colModel[L].hidden===true?true:false;if(h!=="cb"&&h!=="subgrid"&&h!=="rn"){V=h==D.p.ExpandColumn&&D.p.treeGrid===true?a(this).text():a(this).html();a.extend({},D.p.colModel[L].editoptions||{});h=a.jgrid.jqID("v_"+h);a("#"+h+" span","#"+s).html(V);P&&a("#"+h,"#"+s).parents("tr:first").hide();O++}});O>0&&a("#id_g","#"+s).val(l)}}function E(l,D){l===0?a("#pData",
"#"+s+"_2").addClass("ui-state-disabled"):a("#pData","#"+s+"_2").removeClass("ui-state-disabled");l==D?a("#nData","#"+s+"_2").addClass("ui-state-disabled"):a("#nData","#"+s+"_2").removeClass("ui-state-disabled")}function B(){var l=a(A).jqGrid("getDataIDs"),D=a("#id_g","#"+s).val();return[a.inArray(D,l),l]}var A=this;if(A.grid&&f){var n=A.p.id,k="ViewGrid_"+n,s="ViewTbl_"+n,N={themodal:"viewmod"+n,modalhead:"viewhd"+n,modalcontent:"viewcnt"+n,scrollelm:k},c=a.isFunction(b.beforeInitData)?b.beforeInitData:
false,t=true,p=1,j=0;if(a("#"+N.themodal).html()!==null){if(c){t=c(a("#"+k));if(typeof t=="undefined")t=true}if(t===false)return;a(".ui-jqdialog-title","#"+N.modalhead).html(b.caption);a("#FormError","#"+s).hide();x(f,A);a.isFunction(b.beforeShowForm)&&b.beforeShowForm(a("#"+k));a.jgrid.viewModal("#"+N.themodal,{gbox:"#gbox_"+n,jqm:b.jqModal,jqM:false,overlay:b.overlay,modal:b.modal});e()}else{var o=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px";o=a("<form name='FormPost' id='"+k+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+
o+";'></form>");var F=a("<table id='"+s+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");if(c){t=c(a("#"+k));if(typeof t=="undefined")t=true}if(t===false)return;a(A.p.colModel).each(function(){var l=this.formoptions;p=Math.max(p,l?l.colpos||0:0);j=Math.max(j,l?l.rowpos||0:0)});a(o).append(F);r(f,A,F,p);c=A.p.direction=="rtl"?true:false;t="<a href='javascript:void(0)' id='"+(c?"nData":"pData")+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>";
var J="<a href='javascript:void(0)' id='"+(c?"pData":"nData")+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",u="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+b.bClose+"</a>";if(j>0){var y=[];a.each(a(F)[0].rows,function(l,D){y[l]=D});y.sort(function(l,D){if(l.rp>D.rp)return 1;if(l.rp<D.rp)return-1;return 0});a.each(y,function(l,D){a("tbody",F).append(D)})}b.gbox="#gbox_"+n;var G=false;if(b.closeOnEscape===
true){b.closeOnEscape=false;G=true}o=a("<span></span>").append(o).append("<table border='0' class='EditTable' id='"+s+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+b.labelswidth+"'>"+(c?J+t:t+J)+"</td><td class='EditButton'>"+u+"</td></tr></tbody></table>");a.jgrid.createModal(N,o,b,"#gview_"+A.p.id,a("#gview_"+A.p.id)[0]);if(c){a("#pData, #nData","#"+s+"_2").css("float","right");a(".EditButton","#"+s+"_2").css("text-align","left")}b.viewPagerButtons||a("#pData, #nData","#"+s+"_2").hide();
o=null;a("#"+N.themodal).keydown(function(l){if(l.which===27){G&&a.jgrid.hideModal(this,{gb:b.gbox,jqm:b.jqModal,onClose:b.onClose});return false}if(b.navkeys[0]===true){if(l.which===b.navkeys[1]){a("#pData","#"+s+"_2").trigger("click");return false}if(l.which===b.navkeys[2]){a("#nData","#"+s+"_2").trigger("click");return false}}});b.closeicon=a.extend([true,"left","ui-icon-close"],b.closeicon);if(b.closeicon[0]===true)a("#cData","#"+s+"_2").addClass(b.closeicon[1]=="right"?"fm-button-icon-right":
"fm-button-icon-left").append("<span class='ui-icon "+b.closeicon[2]+"'></span>");a.isFunction(b.beforeShowForm)&&b.beforeShowForm(a("#"+k));a.jgrid.viewModal("#"+N.themodal,{gbox:"#gbox_"+n,jqm:b.jqModal,modal:b.modal});a(".fm-button:not(.ui-state-disabled)","#"+s+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});e();a("#cData","#"+s+"_2").click(function(){a.jgrid.hideModal("#"+N.themodal,{gb:"#gbox_"+n,jqm:b.jqModal,onClose:b.onClose});
return false});a("#nData","#"+s+"_2").click(function(){a("#FormError","#"+s).hide();var l=B();l[0]=parseInt(l[0],10);if(l[0]!=-1&&l[1][l[0]+1]){a.isFunction(b.onclickPgButtons)&&b.onclickPgButtons("next",a("#"+k),l[1][l[0]]);x(l[1][l[0]+1],A);a(A).jqGrid("setSelection",l[1][l[0]+1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("next",a("#"+k),l[1][l[0]+1]);E(l[0]+1,l[1].length-1)}e();return false});a("#pData","#"+s+"_2").click(function(){a("#FormError","#"+s).hide();var l=B();if(l[0]!=
-1&&l[1][l[0]-1]){a.isFunction(b.onclickPgButtons)&&b.onclickPgButtons("prev",a("#"+k),l[1][l[0]]);x(l[1][l[0]-1],A);a(A).jqGrid("setSelection",l[1][l[0]-1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("prev",a("#"+k),l[1][l[0]-1]);E(l[0]-1,l[1].length-1)}e();return false})}o=B();E(o[0],o[1].length-1)}})},delGridRow:function(f,b){b=a.extend({top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:false,overlay:30,drag:true,resize:true,url:"",mtype:"POST",reloadAfterSubmit:true,
beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:true,closeOnEscape:false,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:false,serializeDelData:null,useDataProxy:false},a.jgrid.del,b||{});d[a(this)[0].p.id]=b;return this.each(function(){var e=this;if(e.grid)if(f){var r=a.isFunction(d[e.p.id].beforeShowForm),x=a.isFunction(d[e.p.id].afterShowForm),E=a.isFunction(d[e.p.id].beforeInitData)?d[e.p.id].beforeInitData:
false,B=e.p.id,A={},n=true,k="DelTbl_"+B,s,N,c,t,p={themodal:"delmod"+B,modalhead:"delhd"+B,modalcontent:"delcnt"+B,scrollelm:k};if(jQuery.isArray(f))f=f.join();if(a("#"+p.themodal).html()!==null){if(E){n=E(a("#"+k));if(typeof n=="undefined")n=true}if(n===false)return;a("#DelData>td","#"+k).text(f);a("#DelError","#"+k).hide();if(d[e.p.id].processing===true){d[e.p.id].processing=false;a("#dData","#"+k).removeClass("ui-state-active")}r&&d[e.p.id].beforeShowForm(a("#"+k));a.jgrid.viewModal("#"+p.themodal,
{gbox:"#gbox_"+B,jqm:d[e.p.id].jqModal,jqM:false,overlay:d[e.p.id].overlay,modal:d[e.p.id].modal})}else{var j=isNaN(d[e.p.id].dataheight)?d[e.p.id].dataheight:d[e.p.id].dataheight+"px";j="<div id='"+k+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+j+";'>";j+="<table class='DelTable'><tbody>";j+="<tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>";j+="<tr id='DelData' style='display:none'><td >"+f+"</td></tr>";j+='<tr><td class="delmsg" style="white-space:pre;">'+
d[e.p.id].msg+"</td></tr><tr><td >&#160;</td></tr>";j+="</tbody></table></div>";j+="<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+k+"_2'><tbody><tr><td><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton'>"+("<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+b.bSubmit+"</a>")+"&#160;"+("<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+b.bCancel+
"</a>")+"</td></tr></tbody></table>";b.gbox="#gbox_"+B;a.jgrid.createModal(p,j,b,"#gview_"+e.p.id,a("#gview_"+e.p.id)[0]);if(E){n=E(a("#"+k));if(typeof n=="undefined")n=true}if(n===false)return;a(".fm-button","#"+k+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});b.delicon=a.extend([true,"left","ui-icon-scissors"],d[e.p.id].delicon);b.cancelicon=a.extend([true,"left","ui-icon-cancel"],d[e.p.id].cancelicon);if(b.delicon[0]===true)a("#dData",
"#"+k+"_2").addClass(b.delicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.delicon[2]+"'></span>");if(b.cancelicon[0]===true)a("#eData","#"+k+"_2").addClass(b.cancelicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.cancelicon[2]+"'></span>");a("#dData","#"+k+"_2").click(function(){var o=[true,""];A={};var F=a("#DelData>td","#"+k).text();if(a.isFunction(d[e.p.id].onclickSubmit))A=d[e.p.id].onclickSubmit(d[e.p.id],
F)||{};if(a.isFunction(d[e.p.id].beforeSubmit))o=d[e.p.id].beforeSubmit(F);if(o[0]&&!d[e.p.id].processing){d[e.p.id].processing=true;a(this).addClass("ui-state-active");c=e.p.prmNames;s=a.extend({},d[e.p.id].delData,A);t=c.oper;s[t]=c.deloper;N=c.id;F=F.split(",");for(var J in F)if(F.hasOwnProperty(J))F[J]=a.jgrid.stripPref(e.p.idPrefix,F[J]);s[N]=F.join();J=a.extend({url:d[e.p.id].url?d[e.p.id].url:a(e).jqGrid("getGridParam","editurl"),type:d[e.p.id].mtype,data:a.isFunction(d[e.p.id].serializeDelData)?
d[e.p.id].serializeDelData(s):s,complete:function(u,y){if(y!="success"){o[0]=false;o[1]=a.isFunction(d[e.p.id].errorTextFormat)?d[e.p.id].errorTextFormat(u):y+" Status: '"+u.statusText+"'. Error code: "+u.status}else if(a.isFunction(d[e.p.id].afterSubmit))o=d[e.p.id].afterSubmit(u,s);if(o[0]===false){a("#DelError>td","#"+k).html(o[1]);a("#DelError","#"+k).show()}else{if(d[e.p.id].reloadAfterSubmit&&e.p.datatype!="local")a(e).trigger("reloadGrid");else{y=[];y=F.split(",");if(e.p.treeGrid===true)try{a(e).jqGrid("delTreeNode",
e.p.idPrefix+y[0])}catch(G){}else for(var l=0;l<y.length;l++)a(e).jqGrid("delRowData",e.p.idPrefix+y[l]);e.p.selrow=null;e.p.selarrrow=[]}a.isFunction(d[e.p.id].afterComplete)&&setTimeout(function(){d[e.p.id].afterComplete(u,F)},500)}d[e.p.id].processing=false;a("#dData","#"+k+"_2").removeClass("ui-state-active");o[0]&&a.jgrid.hideModal("#"+p.themodal,{gb:"#gbox_"+B,jqm:b.jqModal,onClose:d[e.p.id].onClose})}},a.jgrid.ajaxOptions,d[e.p.id].ajaxDelOptions);if(!J.url&&!d[e.p.id].useDataProxy)if(a.isFunction(e.p.dataProxy))d[e.p.id].useDataProxy=
true;else{o[0]=false;o[1]+=" "+a.jgrid.errors.nourl}if(o[0])if(d[e.p.id].useDataProxy){J=e.p.dataProxy.call(e,J,"del_"+e.p.id);if(typeof J=="undefined")J=[true,""];if(J[0]===false){o[0]=false;o[1]=J[1]||"Error deleting the selected row!"}else a.jgrid.hideModal("#"+p.themodal,{gb:"#gbox_"+B,jqm:b.jqModal,onClose:d[e.p.id].onClose})}else a.ajax(J)}if(o[0]===false){a("#DelError>td","#"+k).html(o[1]);a("#DelError","#"+k).show()}return false});a("#eData","#"+k+"_2").click(function(){a.jgrid.hideModal("#"+
p.themodal,{gb:"#gbox_"+B,jqm:d[e.p.id].jqModal,onClose:d[e.p.id].onClose});return false});r&&d[e.p.id].beforeShowForm(a("#"+k));a.jgrid.viewModal("#"+p.themodal,{gbox:"#gbox_"+B,jqm:d[e.p.id].jqModal,overlay:d[e.p.id].overlay,modal:d[e.p.id].modal})}x&&d[e.p.id].afterShowForm(a("#"+k));d[e.p.id].closeOnEscape===true&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+p.modalhead).focus()},0)}})},navGrid:function(f,b,e,r,x,E,B){b=a.extend({edit:true,editicon:"ui-icon-pencil",add:true,addicon:"ui-icon-plus",
del:true,delicon:"ui-icon-trash",search:true,searchicon:"ui-icon-search",refresh:true,refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:false,viewicon:"ui-icon-document",position:"left",closeOnEscape:true,beforeRefresh:null,afterRefresh:null,cloneToTop:false,alertwidth:200,alertheight:"auto",alerttop:null,alertleft:null,alertzIndex:null},a.jgrid.nav,b||{});return this.each(function(){if(!this.nav){var A={themodal:"alertmod",modalhead:"alerthd",modalcontent:"alertcnt"},n=this,k;if(!(!n.grid||
typeof f!="string")){if(a("#"+A.themodal).html()===null){if(!b.alerttop&&!b.alertleft){if(typeof window.innerWidth!="undefined"){b.alertleft=window.innerWidth;b.alerttop=window.innerHeight}else if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!==0){b.alertleft=document.documentElement.clientWidth;b.alerttop=document.documentElement.clientHeight}else{b.alertleft=1024;b.alerttop=768}b.alertleft=b.alertleft/
2-parseInt(b.alertwidth,10)/2;b.alerttop=b.alerttop/2-25}a.jgrid.createModal(A,"<div>"+b.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+n.p.id,jqModal:true,drag:true,resize:true,caption:b.alertcap,top:b.alerttop,left:b.alertleft,width:b.alertwidth,height:b.alertheight,closeOnEscape:b.closeOnEscape,zIndex:b.alertzIndex},"","",true)}var s=1;if(b.cloneToTop&&n.p.toppager)s=2;for(var N=0;N<s;N++){var c=a("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>"),
t,p;if(N===0){t=f;p=n.p.id;if(t==n.p.toppager){p+="_top";s=1}}else{t=n.p.toppager;p=n.p.id+"_top"}n.p.direction=="rtl"&&a(c).attr("dir","rtl").css("float","right");if(b.add){r=r||{};k=a("<td class='ui-pg-button ui-corner-all'></td>");a(k).append("<div class='ui-pg-div'><span class='ui-icon "+b.addicon+"'></span>"+b.addtext+"</div>");a("tr",c).append(k);a(k,c).attr({title:b.addtitle||"",id:r.id||"add_"+p}).click(function(){a(this).hasClass("ui-state-disabled")||(a.isFunction(b.addfunc)?b.addfunc():
a(n).jqGrid("editGridRow","new",r));return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});k=null}if(b.edit){k=a("<td class='ui-pg-button ui-corner-all'></td>");e=e||{};a(k).append("<div class='ui-pg-div'><span class='ui-icon "+b.editicon+"'></span>"+b.edittext+"</div>");a("tr",c).append(k);a(k,c).attr({title:b.edittitle||"",id:e.id||"edit_"+p}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var j=
n.p.selrow;if(j)a.isFunction(b.editfunc)?b.editfunc(j):a(n).jqGrid("editGridRow",j,e);else{a.jgrid.viewModal("#"+A.themodal,{gbox:"#gbox_"+n.p.id,jqm:true});a("#jqg_alrt").focus()}}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});k=null}if(b.view){k=a("<td class='ui-pg-button ui-corner-all'></td>");B=B||{};a(k).append("<div class='ui-pg-div'><span class='ui-icon "+b.viewicon+"'></span>"+b.viewtext+
"</div>");a("tr",c).append(k);a(k,c).attr({title:b.viewtitle||"",id:B.id||"view_"+p}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var j=n.p.selrow;if(j)a.isFunction(b.viewfunc)?b.viewfunc(j):a(n).jqGrid("viewGridRow",j,B);else{a.jgrid.viewModal("#"+A.themodal,{gbox:"#gbox_"+n.p.id,jqm:true});a("#jqg_alrt").focus()}}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});k=null}if(b.del){k=
a("<td class='ui-pg-button ui-corner-all'></td>");x=x||{};a(k).append("<div class='ui-pg-div'><span class='ui-icon "+b.delicon+"'></span>"+b.deltext+"</div>");a("tr",c).append(k);a(k,c).attr({title:b.deltitle||"",id:x.id||"del_"+p}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var j;if(n.p.multiselect){j=n.p.selarrrow;if(j.length===0)j=null}else j=n.p.selrow;if(j)"function"==typeof b.delfunc?b.delfunc(j):a(n).jqGrid("delGridRow",j,x);else{a.jgrid.viewModal("#"+A.themodal,{gbox:"#gbox_"+
n.p.id,jqm:true});a("#jqg_alrt").focus()}}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});k=null}if(b.add||b.edit||b.del||b.view)a("tr",c).append("<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>");if(b.search){k=a("<td class='ui-pg-button ui-corner-all'></td>");E=E||{};a(k).append("<div class='ui-pg-div'><span class='ui-icon "+b.searchicon+
"'></span>"+b.searchtext+"</div>");a("tr",c).append(k);a(k,c).attr({title:b.searchtitle||"",id:E.id||"search_"+p}).click(function(){a(this).hasClass("ui-state-disabled")||a(n).jqGrid("searchGrid",E);return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});E.showOnLoad&&E.showOnLoad===true&&a(k,c).click();k=null}if(b.refresh){k=a("<td class='ui-pg-button ui-corner-all'></td>");a(k).append("<div class='ui-pg-div'><span class='ui-icon "+
b.refreshicon+"'></span>"+b.refreshtext+"</div>");a("tr",c).append(k);a(k,c).attr({title:b.refreshtitle||"",id:"refresh_"+p}).click(function(){if(!a(this).hasClass("ui-state-disabled")){a.isFunction(b.beforeRefresh)&&b.beforeRefresh();n.p.search=false;try{var j=n.p.id;n.p.postData.filters="";a("#fbox_"+j).jqFilter("resetFilter");a.isFunction(n.clearToolbar)&&n.clearToolbar(false)}catch(o){}switch(b.refreshstate){case "firstpage":a(n).trigger("reloadGrid",[{page:1}]);break;case "current":a(n).trigger("reloadGrid",
[{current:true}]);break}a.isFunction(b.afterRefresh)&&b.afterRefresh()}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});k=null}k=a(".ui-jqgrid").css("font-size")||"11px";a("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+k+";visibility:hidden;' ></div>");k=a(c).clone().appendTo("#testpg2").width();a("#testpg2").remove();a(t+"_"+b.position,t).append(c);
if(n.p._nvtd){if(k>n.p._nvtd[0]){a(t+"_"+b.position,t).width(k);n.p._nvtd[0]=k}n.p._nvtd[1]=k}c=k=k=null;this.nav=true}}}})},navButtonAdd:function(f,b){b=a.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},b||{});return this.each(function(){if(this.grid){if(f.indexOf("#")!==0)f="#"+f;var e=a(".navtable",f)[0],r=this;if(e)if(!(b.id&&a("#"+b.id,e).html()!==null)){var x=a("<td></td>");b.buttonicon.toString().toUpperCase()=="NONE"?a(x).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+
b.caption+"</div>"):a(x).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='ui-icon "+b.buttonicon+"'></span>"+b.caption+"</div>");b.id&&a(x).attr("id",b.id);if(b.position=="first")e.rows[0].cells.length===0?a("tr",e).append(x):a("tr td:eq(0)",e).before(x);else a("tr",e).append(x);a(x,e).attr("title",b.title||"").click(function(E){a(this).hasClass("ui-state-disabled")||a.isFunction(b.onClickButton)&&b.onClickButton.call(r,E);return false}).hover(function(){a(this).hasClass("ui-state-disabled")||
a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")})}}})},navSeparatorAdd:function(f,b){b=a.extend({sepclass:"ui-separator",sepcontent:""},b||{});return this.each(function(){if(this.grid){if(f.indexOf("#")!==0)f="#"+f;var e=a(".navtable",f)[0];if(e){var r="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+b.sepclass+"'></span>"+b.sepcontent+"</td>";a("tr",e).append(r)}}})},GridToForm:function(f,b){return this.each(function(){var e=this;
if(e.grid){var r=a(e).jqGrid("getRowData",f);if(r)for(var x in r)a("[name="+a.jgrid.jqID(x)+"]",b).is("input:radio")||a("[name="+a.jgrid.jqID(x)+"]",b).is("input:checkbox")?a("[name="+a.jgrid.jqID(x)+"]",b).each(function(){a(this).val()==r[x]?a(this)[e.p.useProp?"prop":"attr"]("checked",true):a(this)[e.p.useProp?"prop":"attr"]("checked",false)}):a("[name="+a.jgrid.jqID(x)+"]",b).val(r[x])}})},FormToGrid:function(f,b,e,r){return this.each(function(){var x=this;if(x.grid){e||(e="set");r||(r="first");
var E=a(b).serializeArray(),B={};a.each(E,function(A,n){B[n.name]=n.value});if(e=="add")a(x).jqGrid("addRowData",f,B,r);else e=="set"&&a(x).jqGrid("setRowData",f,B)}})}})})(jQuery);
