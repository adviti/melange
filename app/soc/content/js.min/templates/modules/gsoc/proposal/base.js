melange.templates.inherit(function(a,b){function A(){src="/soc/content/"+d+"/images/v2/gsoc/add.png";add_icon=new Image;add_icon.src=src;o.children().filter("label").html(["<img src='",src,"' />","<a href='javascript:void(0)'>","  Sync with Google Documents","</a>"].join(""))}function z(){if(q.is(":visible")){p.hide();q.hide()}else{q.show();p.show()}}function y(){var a="";if(n.val()){data=jQuery.parseJSON(n.val());a=data.title}r=a;p.val(a);p.autocomplete({source:"?fmt=json&field=google_document",minLength:2,select:function(a,b){if(b.item){n.val(b.item.json);r=b.item.value;q.removeClass("disabled")}}});p.autocomplete("disable")}function x(){p.autocomplete("enable")}function w(){if(f||g){return}q.html(i);g=true;data=jQuery.parseJSON(n.val());jQuery.ajax({type:"GET",dataType:"json",url:e,data:{fmt:"json",document_id:data.id},success:function(a){tinyMCE.editors[0].setContent(a.content)},error:function(a){alert("Unable to sync! Make sure you're logged in to Google Docs.")},complete:function(a,b){q.html(h);g=false}})}function v(){html=["<a id='",m,"' ","href='javascript:void(0)' ","class='small-orange-button' ","style='display:none'>",h,"</a>"].join("");p.after(html);q=jQuery("#"+m);if(!n.val()){t()}p.change(function(){t()});p.keydown(function(){if(p.val()!==r){t()}})}function u(){q.removeClass("disabled");f=true}function t(){q.addClass("disabled");f=false}function s(){p=n.clone().attr("id",l).attr("name","pretty_google_document").attr("type","text").hide();n.after(p)}if(window.melange.gdata===undefined){throw new Error("Melange GData not loaded")}var c=window.melange;var d=c.config.app_version;var e=b.proposal_sync_url;var f=false;var g=false;var h="Sync Now";var i="Syncing...";var j="google_document";var k="form_row_google_document";var l="pretty_google_document";var m="sync_now";var n=jQuery("#"+j);var o=jQuery("#"+k);var p=null;var q=null;var r="";jQuery(function(){s();v();A();y();fn=c.gdata.loginFunctionFactory(w,[]);q.click(fn);fn=c.gdata.loginFunctionFactory(x,[]);p.focus(fn);fn=c.gdata.loginFunctionFactory(z,[]);o.children().filter("label").click(fn)})})
